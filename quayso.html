<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quay S·ªë L√¨ X√¨</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
       body {
    background: url('anhbia.png') no-repeat center center fixed;
    background-size: cover;
    text-align: center;
    padding: 50px;
    font-family: 'Poppins', sans-serif;
    color: #fff;
}

.container {
    max-width: 600px;
    margin: auto;
    background: rgba(255, 255, 255, 0.9); /* Gi·ªØ n·ªÅn m·ªù */
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 0 25px rgba(0,0,0,0.3);
    border: 6px solid #d0021b;
    animation: fadeIn 1.5s ease-in-out;
}

@keyframes fadeIn {
    0% { opacity: 0; transform: scale(0.9); }
    100% { opacity: 1; transform: scale(1); }
}

h1 {
    font-family: 'Pacifico', cursive;
    font-size: 50px;
    color: #d0021b;
    text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.btn-primary, .btn-success {
    font-weight: bold;
    font-size: 22px;
    border-radius: 15px;
    padding: 15px 30px;
    background: linear-gradient(90deg, #ff4b2b, #ff416c);
    color: #fff;
    border: none;
    transition: all 0.3s ease-in-out;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.btn-primary:hover, .btn-success:hover {
    transform: scale(1.1);
    background: linear-gradient(90deg, #ff416c, #ff4b2b);
}

#result {
    font-size: 26px;
    font-weight: bold;
    color: #28a745;
    background: rgba(255, 255, 255, 0.9);
    padding: 20px;
    border-radius: 15px;
    border: 4px solid #28a745;
    margin-top: 20px;
    box-shadow: 0 0 20px rgba(0,0,0,0.2);
    display: none;
    animation: fadeIn 1s ease-in-out;
}

.lucky-spin {
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

/* Hi·ªÉn th·ªã danh s√°ch ng∆∞·ªùi nh·∫≠n th∆∞·ªüng v·ªõi hi·ªáu ·ª©ng s·ªëng ƒë·ªông */
#recentWinners {
    position: fixed;
    top: 10%;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    pointer-events: none;
    z-index: 1000;
}

.winner-item {
    position: absolute;
    font-size: 24px;
    font-weight: bold;
    color: #000; /* Ch·ªØ ƒëen d·ªÖ ƒë·ªçc */
    white-space: nowrap;
    opacity: 0;
    animation: fadeMove 12s linear forwards;
    text-shadow: 2px 2px 5px rgba(255, 255, 255, 0.9);
}

@keyframes fadeMove {
    0% {
        left: 100%;
        opacity: 0;
    }
    10% {
        opacity: 1;
    }
    90% {
        opacity: 1;
    }
    100% {
        left: -100%;
        opacity: 0;
    }
}

/* Hi·ªáu ·ª©ng ph√°o hoa */
.fireworks {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
}

.fireworks span {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 8px;
    height: 8px;
    background: #ff0;
    border-radius: 50%;
    animation: explode 1.5s ease-out infinite;
}

@keyframes explode {
    0% { transform: scale(1); opacity: 1; }
    100% { transform: scale(10); opacity: 0; }
}

    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">Ch√∫c M·ª´ng NƒÉm M·ªõi!</h1>
        <p class="mb-4" style="color: black;">Nh·∫•n v√†o n√∫t d∆∞·ªõi ƒë√¢y ƒë·ªÉ nh·∫≠n l·∫•y con s·ªë may m·∫Øn c·ªßa b·∫°n!</p>
        <button id="spinBtn" class="btn btn-primary lucky-spin">üéÅ Quay S·ªë Ngay</button>
        <div id="result" class="mt-4" style="display: none;">
            <p>üéâ Ch√∫c m·ª´ng! B·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c: <span id="luckyNumber" class="fw-bold text-danger"></span> VNƒê ti·ªÅn l√¨ x√¨ t·ª´ DanhLo üéâ</p>
            <button id="receiveMoneyBtn" class="btn btn-success">üí∞ Nh·∫≠n L√¨ X√¨</button>
        </div>
    </div>
    <div id="recentWinners"></div>
    <audio id="bg-music" loop>
        <source src="./nhactet.mp3" type="audio/mpeg">
    </audio>
    
    <div id="infoModal" class="modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 400px; height: 350px; background-color: rgba(255, 255, 255, 0.95); border-radius: 16px; box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3); padding: 24px; z-index: 1000; text-align: center; font-family: Arial, sans-serif;">
        <h2 class="mb-3" style="font-size: 1.5rem; font-weight: bold; color: #D0021B;">Nh·∫≠p Th√¥ng Tin Nh·∫≠n Ti·ªÅn</h2>
        <div class="form-group" style="margin-bottom: 16px;">
            <label for="accountNumber" style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">S·ªë t√†i kho·∫£n</label>
            <input type="text" id="accountNumber" class="form-control" style="width: 90%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-family: Arial, sans-serif;" placeholder="Nh·∫≠p s·ªë t√†i kho·∫£n">
        </div>
        <div class="form-group" style="margin-bottom: 16px;">
            <label for="bankName" style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">T√™n ng√¢n h√†ng</label>
            <input type="text" id="bankName" class="form-control" style="width: 90%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-family: Arial, sans-serif;" placeholder="Nh·∫≠p t√™n ng√¢n h√†ng">
        </div>
        <div>
            <button id="closeModalBtn" class="btn btn-secondary" style="padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 1rem;">Tho√°t</button>
        </div>
    </div>
    <div id="overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); z-index: 999;"></div>
    
    
   

    <script>
       document.getElementById('spinBtn').addEventListener('click', function () {
        let spinBtn = document.getElementById('spinBtn');
        if (spinBtn.disabled) return;

        spinBtn.disabled = true;
        spinBtn.classList.remove('lucky-spin');
        spinBtn.innerText = "üéâ ƒê√£ Quay!";

        let luckyNumber;
        let random = Math.random();

        if (random < 0.9) { 
    // 90% nh·∫≠n t·ª´ 5k ƒë·∫øn 30k
    luckyNumber = Math.floor(Math.random() * 26) + 5;
} else if (random < 0.99) { 
    // 9% nh·∫≠n t·ª´ 30k ƒë·∫øn 50k
    luckyNumber = Math.floor(Math.random() * 21) + 30;
} else { 
    // 1% nh·∫≠n tr√™n 50k (51k - 100k)
    luckyNumber = Math.floor(Math.random() * 50) + 51;
}

        document.getElementById('luckyNumber').innerText = luckyNumber * 1000;
        document.getElementById('result').style.display = "block";
    });

    document.getElementById('receiveMoneyBtn').addEventListener('click', function () {
        document.getElementById('infoModal').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    });

    document.getElementById('closeModalBtn').addEventListener('click', function () {
        const accountNumber = document.getElementById('accountNumber').value.trim();
        const bankName = document.getElementById('bankName').value.trim();
        const luckyNumber = document.getElementById('luckyNumber').innerText;
        const name = localStorage.getItem('name'); // T√™n ng∆∞·ªùi d√πng t·ª´ localStorage
        const scriptURL = "https://script.google.com/macros/s/AKfycbxmuo6Q77ZRcxpeXiJR04ew-Kvj5YUhhjJWqPAvyEKfCruPMjLFX6LSGkcNZrnCaDOY/exec";

        // Ki·ªÉm tra th√¥ng tin nh·∫≠p
        if (!accountNumber || !bankName || !name || !luckyNumber) {
            alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin t√†i kho·∫£n v√† ng√¢n h√†ng!');
            return;
        }

        // G·ª≠i d·ªØ li·ªáu l√™n Google Sheet
        const formData = new FormData();
        formData.append('action', 'update'); // H√†nh ƒë·ªông c·∫≠p nh·∫≠t
        formData.append('name', name);       // T√™n ng∆∞·ªùi nh·∫≠n
        formData.append('bank', bankName);  // T√™n ng√¢n h√†ng
        formData.append('account', accountNumber); // S·ªë t√†i kho·∫£n
        formData.append('amount', luckyNumber); // S·ªë ti·ªÅn l√¨ x√¨
        formData.append('time', new Date().toLocaleString()); // Th·ªùi gian g·ª≠i

        fetch(scriptURL, { method: 'POST', body: formData })
            .then(response => response.text())
            .then(result => {
                if (result.trim() === "SUCCESS") {
                    alert('Th√¥ng tin ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n. Ch√∫c b·∫°n m·ªôt nƒÉm m·ªõi vui v·∫ª!');
                    localStorage.clear();
                    window.location.href = 'index.html';
                } else {
                    alert('ƒê√£ x·∫£y ra l·ªói khi g·ª≠i th√¥ng tin. Vui l√≤ng th·ª≠ l·∫°i!');
                }
            })
            .catch(error => {
                alert('L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i!');
            });
    });

function fetchWinners() {
        const sheetURL = "https://script.google.com/macros/s/AKfycbxmuo6Q77ZRcxpeXiJR04ew-Kvj5YUhhjJWqPAvyEKfCruPMjLFX6LSGkcNZrnCaDOY/exec";

        fetch(sheetURL)
            .then(response => response.json())
            .then(data => {
                let winnerContainer = document.getElementById('recentWinners');
                winnerContainer.innerHTML = ""; // X√≥a n·ªôi dung c≈©

                let validEntries = data.filter(entry => entry.name && entry.amount);
                let recentEntries = validEntries.slice(-10); // L·∫•y 10 ng∆∞·ªùi g·∫ßn nh·∫•t

                if (recentEntries.length === 0) {
                    return;
                }

                recentEntries.forEach((entry, index) => {
                    setTimeout(() => {
                        addFloatingWinner(entry.name, entry.amount);
                    }, index * 4000); // Hi·ªÉn th·ªã c√°ch nhau 4 gi√¢y
                });
            })
            .catch(error => {
                console.error("Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu t·ª´ Sheets", error);
            });
    }
   
    function addFloatingWinner(name, amount) {
        let winnerContainer = document.getElementById('recentWinners');
        let listItem = document.createElement('div');
        listItem.classList.add("winner-item");
        listItem.innerText = `${name} ƒë√£ nh·∫≠n ${amount} VNƒê ti·ªÅn l√¨ x√¨ t·ª´ DanhLo üéâ`;

        // Gi·ªõi h·∫°n v·ªã tr√≠ xu·∫•t hi·ªán trong ph·∫°m vi b·∫£ng ch√∫c m·ª´ng
        let randomTop = Math.random() * 20 + 20;  // Xu·∫•t hi·ªán ng·∫´u nhi√™n t·ª´ 20% ƒë·∫øn 40% chi·ªÅu cao m√†n h√¨nh
        listItem.style.top = `${randomTop}vh`;

        winnerContainer.appendChild(listItem);

        setTimeout(() => {
            listItem.remove();
        }, 10000);  // X√≥a ph·∫ßn t·ª≠ sau khi ho√†n th√†nh hi·ªáu ·ª©ng
    }

    setInterval(fetchWinners, 60000);
    fetchWinners();
   // Ch·ªù s·ª± ki·ªán click ƒë·ªÉ g·ª≠i t√≠n hi·ªáu ph√°t nh·∫°c ƒë·∫øn iframe

   document.addEventListener("DOMContentLoaded", function () {
    let audio = document.getElementById('bg-music');

    // Kh√¥i ph·ª•c th·ªùi gian ph√°t v√† tr·∫°ng th√°i ph√°t n·∫øu c√≥ l∆∞u tr∆∞·ªõc ƒë√≥
    let savedTime = localStorage.getItem('audioTime');
    let isPlaying = localStorage.getItem('isPlaying') === 'true';

    if (savedTime) {
        audio.currentTime = parseFloat(savedTime) || 0;
    }

    if (isPlaying) {
        audio.play().then(() => {
            console.log("Nh·∫°c ti·∫øp t·ª•c ph√°t t·ª´ v·ªã tr√≠ ƒë√£ l∆∞u.");
        }).catch(() => {
            console.log("Autoplay b·ªã ch·∫∑n, ch·ªù thao t√°c t·ª´ ng∆∞·ªùi d√πng.");

            // Ch·ªù ng∆∞·ªùi d√πng click v√†o b·∫•t k·ª≥ ƒë√¢u tr√™n trang ƒë·ªÉ ph√°t nh·∫°c
            document.addEventListener('click', function playAudioOnce() {
                audio.play();
                console.log("Nh·∫°c b·∫Øt ƒë·∫ßu ph√°t sau khi ng∆∞·ªùi d√πng t∆∞∆°ng t√°c.");
                document.removeEventListener('click', playAudioOnce);
            });
        });
    } else {
        // N·∫øu nh·∫°c ch∆∞a t·ª´ng ph√°t, th·ª≠ ph√°t l·∫ßn ƒë·∫ßu
        audio.play().then(() => {
            console.log("Nh·∫°c ph√°t l·∫ßn ƒë·∫ßu.");
            localStorage.setItem('isPlaying', 'true');
        }).catch(() => {
            console.log("Autoplay b·ªã ch·∫∑n, ch·ªù thao t√°c t·ª´ ng∆∞·ªùi d√πng.");
            document.addEventListener('click', function playAudioOnce() {
                audio.play();
                localStorage.setItem('isPlaying', 'true');
                console.log("Nh·∫°c b·∫Øt ƒë·∫ßu ph√°t sau khi ng∆∞·ªùi d√πng t∆∞∆°ng t√°c.");
                document.removeEventListener('click', playAudioOnce);
            });
        });
    }

    // L∆∞u l·∫°i th·ªùi gian ph√°t m·ªói gi√¢y
    setInterval(() => {
        if (!audio.paused) {
            localStorage.setItem('audioTime', audio.currentTime);
        }
    }, 1000);

    // L∆∞u tr·∫°ng th√°i khi ng∆∞·ªùi d√πng r·ªùi kh·ªèi trang
    window.addEventListener('beforeunload', () => {
        localStorage.setItem('isPlaying', !audio.paused);
        localStorage.setItem('audioTime', audio.currentTime);
    });
});

// X√≥a tr·∫°ng th√°i khi nh·∫°c b·ªã d·ª´ng
document.getElementById('bg-music').onpause = function () {
    localStorage.removeItem('isPlaying');
};


</script>
</body>
</html>
